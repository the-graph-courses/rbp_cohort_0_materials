---
title: "Honors Assignment: Creating interactive ggplots"
output:
  prettydoc::html_pretty:
    theme: architect
    toc: true
    number_sections: true
author: "Author's name here"
date: "2023-01-01"
editor_options: 
  chunk_output_type: console
---

```{r include = FALSE}
library(knitr)
```

# Intro

Welcome!

For this assignment, you will need to create a ggplot graph and add interactivity to it using the **{plotly}** package.  https://plotly.com/ggplot2/.

The final due date for the assignment is Tuesday, January 31th at 23:59 PM UTC+2.


# Getting started

Let's begin by loading the packages you will need to use: 

```{r}
# Load packages 
if(!require(pacman)) install.packages("pacman")
pacman::p_load(plotly, # for adding interactivity!
               tidyverse, # for ggplot2 and dplyr
               htmlwidgets, # for saving interactive graph
               gapminder # for data
               )
```
    
We have not yet used {plotly} in this course. This code will install the package if you don't have it already.

Next, we will load in and prepare data.

In this lesson, we will be using the `gapminder` dataset, but only the data from 2007.

```{r}
# Import data frame from gapminder package
gapminder07 <- gapminder::gapminder %>%
  # filter data frame to only include data from 2007
  filter(year == 2007) %>%
  # remove the year column
  select(-year)
```
 
```{r}
# View dataset
head(gapminder07, 10)
```


# Intro to plotly

The **plotly** package is used to create interactive graphs in R and Python. It can used to make a variety of plot types, just like ggplot. 

An interactive chart allows you to change what the chart shows by taking actions: pan and zoom, hover over a geom to get additional information, choose which variables to display, and more.

Let's say we want to view the relationship between life expectancy and GPD per capita in `gapminder07` using a interactive scatter plot. 

We could do this using the `plot_ly()` function, which will produce an interactive plot will in your Viewer pane. After running the code below, you can hover over the points on the interactive scatter plot to view the raw data values for x and y. 

```{r}
# Interactive scatter plot using plot_ly() directly
plot_ly(data = gapminder07,
        type = "scatter",
        x = ~gdpPercap, 
        y = ~lifeExp) 

# (Note: this is just an example, we will not be using this method)
```

However, we will not be using this method. Instead of learning a whole new syntax, we can continue to make plots with {ggplot2} and turn them interactive using the **`ggplotly()`** function. This converts ggplot objects into interactive plots with just one additional line of code!

You can indirectly create an interactive {plotly} graph in two simple steps:

1.  Create a named ggplot2 plot using the **`ggplot()`** function and the assignment operator (`<-`).

2.  Use the **`ggplotly()`** function to convert the ggplot2 plot into an interactive plotly plot: **`ggplotly(PLOT_NAME)`**


**Step 1: Create ggplot object**

```{r}
# First create ggplot object
base_ggplot <- 
  ggplot(data = gapminder07,
         mapping = aes(x = gdpPercap,
                       y = lifeExp)) +
  geom_point()
```

**Step 2: Add interactivity with `ggplotly()`**

```{r}
# Transform plot with ggplotly()
ggplotly(base_ggplot)
```

Aesthetic modifications like color, size, theme, etc. will also translate to plotly.

```{r}

```

## Labels

We can add country labels to hover text using the `label` aesthetic inside `aes()`.

```{r}

# Create a ggplot2 plot with data labels for the country variable
gapminder_plot <- ggplot(
  data = gapminder07,
  mapping = aes(
    x = gdpPercap,
    y = lifeExp,
    label = country)) +
  geom_point()

# Convert the ggplot2 plot to an interactive plotly plot

ggplotly(gapminder_plot)
```


# Save interactive plot as HTML widget

You can use the `htmlwidgets::saveWidget` function from the `htmlwidgets` package to save a {plotly} plot as an HTML file. This will allow you to view the plot in a web browser, where you can interact with it.

```{r}
library(htmlwidgets)
# Create a plotly plot
gapminder_plotly <- ggplotly(gapminder_plot)

# Save the plotly plot as an HTML file
htmlwidgets::saveWidget(gapminder_plotly, "gap_plot_widget.html")
```

Here, the `saveWidget` function takes two arguments: the first argument is the plotly plot object, and the second argument is the file name of the HTML file you want to save the plot to. The HTML file will be saved in the current working directory.

When you open the saved HTML file in a web browser, it will show the interactive plotly plot, and you can use all its interactive features such as zoom, pan, hover-over text, etc.

# Requirements

- use at least 3 aesthetic mappings 
- at least one fixed aesthetic
- edit scale or position arguments in ggplot
- use the `labs()` function
- add additional variables to hover text
- save as widget

# Submission: Upload zipped folder

Once you have finished the tasks above, you should **create a zipped file** of your project folder, containing all the work you have done, and **upload it** on the assignment page [LINK].

The final due date for the assignment is Tuesday, January 31th at 23:59 PM UTC+2.